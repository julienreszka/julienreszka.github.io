<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Universal Path Finder - AI-Powered Journey Planner</title>
    <meta
      name="description"
      content="AI-powered universal path finder that creates personalized journey maps from any starting point to any destination. Map your path to fitness, career goals, skills, and more."
    />
    <meta
      name="keywords"
      content="path finder, journey planner, goal setting, AI planning, personal development, route mapping, universal navigation"
    />
    <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.5.0/cytoscape-dagre.js"></script>
    <script src="https://unpkg.com/marked@9.1.6/marked.min.js"></script>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="app-header">
      <h1 class="app-title">UPF</h1>
      <div class="header-buttons">
        <button id="settingsBtn">âš™ï¸</button>
        <button id="shareBtn">ğŸ”—</button>
        <button id="helpBtn">â”</button>
      </div>
    </div>

    <div class="controls">
      <div class="input-group">
        <label for="startingPoint">Starting Point (where you are now)</label>
        <div class="input-with-buttons">
          <input type="text" id="startingPoint" placeholder="Fat" />
        </div>
      </div>

      <div class="destinations-container">
        <div class="destinations-header">
          <label>Destinations (in order)</label>
          <button id="addDestinationBtn" class="add-btn">
            + Add Destination
          </button>
        </div>
        <div id="destinationsList">
          <div class="input-group destination-group">
            <div class="input-with-buttons">
              <input
                type="text"
                class="destination-input"
                placeholder="e.g., Fit"
              />
              <button class="remove-destination-btn" style="display: none">
                Ã—
              </button>
            </div>
          </div>
        </div>
      </div>
      <button id="generateBtn">ğŸ—ºï¸ Find Path</button>
    </div>

    <!-- Help Modal -->
    <dialog id="helpModal" class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Legend & Instructions</h3>
          <span class="close" id="closeModal">&times;</span>
        </div>
        <div class="modal-body">
          <div
            id="modalJourneyDisplay"
            class="theme-display"
            style="display: none"
          >
            <strong>Current Journey:</strong>
            <span id="modalCurrentJourney"></span>
          </div>

          <div class="legend">
            <h3>How to Use Universal Path Finder</h3>
            <div class="legend-item">
              <strong>ğŸ¯ Starting Point:</strong> Describe your current
              situation in detail (location, skills, resources, constraints)
            </div>
            <div class="legend-item">
              <strong>ğŸ† Destination Goal:</strong> Define where you want to be
              (specific outcomes, achievements, states)
            </div>
            <div class="legend-item">
              <strong>ğŸ—ºï¸ Find Path:</strong> AI generates a personalized journey
              map with milestones and actions
            </div>
            <div
              class="legend-item"
              style="
                margin-top: 1rem;
                padding-top: 0.5rem;
                border-top: 1px solid var(--border-color);
              "
            >
              <strong>Node Types:</strong>
            </div>
            <div class="legend-item">
              <div
                class="legend-symbol"
                style="background: #2ecc71; border-radius: 8px"
              ></div>
              Starting Point - Your current situation
            </div>
            <div class="legend-item">
              <div class="legend-symbol" style="background: #3498db"></div>
              Action Steps - Things you need to do
            </div>
            <div class="legend-item">
              <div
                class="legend-symbol"
                style="background: #9b59b6; transform: rotate(45deg)"
              ></div>
              Milestones - Key achievements to reach
            </div>
            <div class="legend-item">
              <div
                class="legend-symbol"
                style="
                  background: #e74c3c;
                  clip-path: polygon(
                    50% 0%,
                    0% 38%,
                    0% 100%,
                    100% 100%,
                    100% 38%
                  );
                "
              ></div>
              Resources - Tools, knowledge, or support needed
            </div>
            <div class="legend-item">
              <div
                class="legend-symbol"
                style="
                  background: #f39c12;
                  clip-path: polygon(
                    50% 0%,
                    61% 35%,
                    98% 35%,
                    68% 57%,
                    79% 91%,
                    50% 70%,
                    21% 91%,
                    32% 57%,
                    2% 35%,
                    39% 35%
                  );
                "
              ></div>
              Goal - Your final destination
            </div>
            <div
              class="legend-item"
              style="
                margin-top: 1rem;
                padding-top: 0.5rem;
                border-top: 1px solid var(--border-color);
              "
            >
              <strong>ğŸ“Š Click Node:</strong> Get detailed guidance and tips
            </div>
            <div class="legend-item" style="margin-top: 0.5rem">
              <strong>ğŸ’¡ Double-click/double-tap Node:</strong> Expand with more
              detailed sub-steps
            </div>
            <div class="legend-item" style="margin-top: 0.5rem">
              <strong>ğŸ”— Click Edge:</strong> Understand why this step leads to
              the next
            </div>
            <div class="legend-item" style="margin-top: 0.5rem">
              <strong>ğŸ¯ Double-click/double-tap Space:</strong> Add alternative
              paths or additional goals
            </div>
            <div
              class="legend-item"
              style="
                margin-top: 1rem;
                padding-top: 0.5rem;
                border-top: 1px solid var(--border-color);
              "
            >
              <strong>âš™ï¸ Settings:</strong> Configure your AI provider and API
              keys
            </div>

            <div
              class="legend-item"
              style="
                margin-top: 1rem;
                padding-top: 0.5rem;
                border-top: 1px solid var(--border-color);
              "
            >
              Created by @julienreszka
            </div>
          </div>
        </div>
      </div>
    </dialog>

    <!-- Settings Modal -->
    <dialog id="settingsModal" class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Settings</h3>
          <span class="close" id="closeSettingsModal">&times;</span>
        </div>
        <div class="modal-body">
          <div class="settings-section">
            <h4>AI Provider</h4>
            <div class="radio-group">
              <label class="radio-option">
                <input
                  type="radio"
                  name="provider"
                  value="groq"
                  id="groqProvider"
                  checked
                />
                <span class="radio-label">
                  <strong>Groq</strong>
                  <small>Fast, cost-effective (Llama models)</small>
                </span>
              </label>
              <label class="radio-option">
                <input
                  type="radio"
                  name="provider"
                  value="grok"
                  id="grokProvider"
                />
                <span class="radio-label">
                  <strong>Grok 4</strong>
                  <small>Advanced reasoning with real-time information</small>
                </span>
              </label>
              <label class="radio-option">
                <input
                  type="radio"
                  name="provider"
                  value="grok-fast"
                  id="grokFastProvider"
                />
                <span class="radio-label">
                  <strong>Grok 4.1 Fast</strong>
                  <small>Lightning fast with current events & news</small>
                </span>
              </label>
            </div>
          </div>

          <div class="settings-section">
            <h4>API Keys</h4>

            <div class="api-key-section" id="groqKeySection">
              <label for="groqApiKey">Groq API Key</label>
              <form autocomplete="off">
                <div class="input-with-button">
                  <input
                    type="password"
                    id="groqApiKey"
                    placeholder="Enter your Groq API key"
                    autocomplete="new-password"
                  />
                  <button type="button" id="toggleGroqKey" class="toggle-key">
                    ğŸ‘ï¸
                  </button>
                </div>
              </form>
              <small
                >Get your free key at
                <a href="https://console.groq.com/keys" target="_blank"
                  >console.groq.com/keys</a
                ></small
              >
            </div>

            <div
              class="api-key-section"
              id="grokKeySection"
              style="display: none"
            >
              <label for="grokApiKey">Grok (xAI) API Key</label>
              <form autocomplete="off">
                <div class="input-with-button">
                  <input
                    type="password"
                    id="grokApiKey"
                    placeholder="Enter your Grok API key"
                    autocomplete="new-password"
                  />
                  <button type="button" id="toggleGrokKey" class="toggle-key">
                    ğŸ‘ï¸
                  </button>
                </div>
              </form>
              <small
                >Get your key at
                <a
                  href="https://console.x.ai/team/default/api-keys"
                  target="_blank"
                  >console.x.ai</a
                >
                (works for both Grok 4 & Grok 4.1 Fast)</small
              >
            </div>
          </div>

          <div class="settings-section">
            <h4>Graph Layout</h4>
            <div class="radio-group">
              <label class="radio-option">
                <input type="radio" name="layout" value="auto" checked />
                <div class="radio-label">
                  <strong>Automatic (Recommended)</strong>
                  <small>Uses COSE layout for optimal node positioning</small>
                </div>
              </label>
              <label class="radio-option">
                <input type="radio" name="layout" value="cose" />
                <div class="radio-label">
                  <strong>COSE (Force-directed)</strong>
                  <small
                    >Physics-based layout that simulates forces between nodes
                    for organic positioning</small
                  >
                </div>
              </label>
              <label class="radio-option">
                <input type="radio" name="layout" value="dagre" />
                <div class="radio-label">
                  <strong>Dagre (Hierarchical)</strong>
                  <small
                    >Structured top-down layout ideal for workflow and process
                    visualization</small
                  >
                </div>
              </label>
            </div>
          </div>

          <div class="settings-section">
            <button id="saveSettings" class="save-button">Save Settings</button>
          </div>

          <div class="settings-section">
            <button id="copyAppLink" class="copy-link-button">
              ğŸ“‹ Copy App Settings Link
            </button>
            <small
              style="
                color: var(--text-secondary);
                font-size: 0.8rem;
                margin-top: 0.5rem;
                display: block;
                text-align: center;
              "
            >
              Share this link to give others access with your API keys
              pre-configured
            </small>

            <button id="copyAppLinkWithGraph" class="copy-link-button">
              ğŸ”—ğŸ“Š Copy Complete Link (settings + journey)
            </button>
            <small
              style="
                color: var(--text-secondary);
                font-size: 0.8rem;
                margin-top: 0.5rem;
                display: block;
                text-align: center;
              "
            >
              Share your complete setup including the current diagram
            </small>
          </div>
        </div>
      </div>
    </dialog>

    <!-- Node Explanation Dialog -->
    <dialog id="nodeDialog" class="explanation-dialog">
      <div class="dialog-content">
        <div class="dialog-header">
          <h3 id="nodeDialogTitle">ğŸ“Š Node Title</h3>
          <button class="dialog-close" onclick="closeNodeDialog()">
            &times;
          </button>
        </div>
        <div class="dialog-body">
          <p id="nodeDialogContent">Loading explanation...</p>
        </div>
        <div class="dialog-footer">
          <button onclick="closeNodeDialog()" class="dialog-btn">Close</button>
        </div>
      </div>
    </dialog>

    <!-- Relationship Explanation Dialog -->
    <dialog id="relationshipDialog" class="explanation-dialog">
      <div class="dialog-content">
        <div class="dialog-header">
          <h3 id="relationshipDialogTitle">ğŸ”— Relationship</h3>
          <button class="dialog-close" onclick="closeRelationshipDialog()">
            &times;
          </button>
        </div>
        <div class="dialog-body">
          <p id="relationshipDialogContent">Loading explanation...</p>
        </div>
        <div class="dialog-footer">
          <button onclick="closeRelationshipDialog()" class="dialog-btn">
            Close
          </button>
        </div>
      </div>
    </dialog>

    <!-- Goal Suggestion Dialog -->
    <dialog id="goalSuggestionDialog" class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ğŸ¯ Suggested Goals</h3>
          <span class="close" onclick="closeGoalSuggestionDialog()"
            >&times;</span
          >
        </div>
        <div class="modal-body">
          <div class="theme-display">
            <strong>Starting from:</strong>
            <span id="goalSuggestionStartingPoint"></span>
          </div>
          <div class="settings-section">
            <h4>Choose your destination goal:</h4>
            <div id="goalSuggestionList" class="radio-group">
              <!-- Goal suggestions will be populated here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="useSelectedGoal" class="save-button" disabled>
            Use Selected Goal
          </button>
          <button
            id="customGoalBtn"
            class="copy-link-button"
            style="margin-top: 0.5rem"
          >
            Enter Custom Goal Instead
          </button>
        </div>
      </div>
    </dialog>

    <!-- Starting Point Suggestion Dialog -->
    <dialog id="startingSuggestionDialog" class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ğŸ Suggested Starting Points</h3>
          <span class="close" onclick="closeStartingSuggestionDialog()"
            >&times;</span
          >
        </div>
        <div class="modal-body">
          <div class="theme-display">
            <strong>Goal destination:</strong>
            <span id="startingSuggestionGoal"></span>
          </div>
          <div class="settings-section">
            <h4>Where are you starting from:</h4>
            <div id="startingSuggestionList" class="radio-group">
              <!-- Starting point suggestions will be populated here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="useSelectedStarting" class="save-button" disabled>
            Use Selected Starting Point
          </button>
          <button
            id="customStartingBtn"
            class="copy-link-button"
            style="margin-top: 0.5rem"
          >
            Enter Custom Starting Point Instead
          </button>
        </div>
      </div>
    </dialog>

    <!-- Journey Discovery Dialog -->
    <dialog id="journeyDiscoveryDialog" class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ğŸ—ºï¸ Discover Your Journey</h3>
          <span class="close" onclick="closeJourneyDiscoveryDialog()"
            >&times;</span
          >
        </div>
        <div class="modal-body">
          <div class="theme-display">
            <strong>Let's help you find a path to explore!</strong>
          </div>
          <div class="settings-section">
            <h4>Popular journeys to get you started:</h4>
            <div id="journeyDiscoveryList" class="radio-group">
              <!-- Popular journey suggestions will be populated here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="useSelectedJourney" class="save-button" disabled>
            Explore This Journey
          </button>
          <button
            id="customJourneyBtn"
            class="copy-link-button"
            style="margin-top: 0.5rem"
          >
            I'll Enter My Own Journey
          </button>
        </div>
      </div>
    </dialog>

    <div class="main-container">
      <div id="cy"></div>
      <div
        id="loadingIndicator"
        class="loading"
        style="
          display: none;
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          z-index: 100;
          background: var(--surface-color);
          padding: 2rem;
          border-radius: 1.75rem;
          box-shadow: 0 4px 25px var(--shadow-strong);
        "
      >
        <div class="spinner"></div>
        <p>Mapping your personalized journey path...</p>
      </div>
      <div
        id="errorDisplay"
        class="error"
        style="
          display: none;
          position: absolute;
          top: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 100;
          max-width: 500px;
        "
      ></div>
    </div>
  </body>
  <script src="js/core.js"></script>
  <script src="js/api.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/main-events.js"></script>
  <script src="js/settings-modal.js"></script>
  <script src="js/sharing.js"></script>
  <script src="js/modal-dialogs.js"></script>
  <script src="js/app-init.js"></script>
</html>
